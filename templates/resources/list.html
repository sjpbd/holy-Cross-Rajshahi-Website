{% extends 'base.html' %}

{% block title %}Resources & Downloads - Holy Cross School and College{% endblock %}

{% block content %}
<!-- Hero Section -->
<section
    class="pt-24 pb-20 bg-gradient-to-br from-primary via-primary-dark to-black text-white relative overflow-hidden">
    <!-- Sophisticated Background Elements -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div
            class="absolute top-[-10%] right-[-5%] w-[40rem] h-[40rem] bg-primary-light/10 rounded-full blur-3xl animate-pulse">
        </div>
        <div class="absolute bottom-[-10%] left-[-5%] w-[30rem] h-[30rem] bg-accent/5 rounded-full blur-3xl"></div>
        <div class="absolute inset-0 decorative-dots opacity-10"></div>
    </div>

    <div class="container mx-auto px-4 relative z-10">
        <nav class="breadcrumb mb-6 inline-flex bg-white/5 backdrop-blur-md px-4 py-2 rounded-full border border-white/10"
            data-aos="fade-down">
            <div class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></div>
            <div class="breadcrumb-item active">Resources</div>
        </nav>

        <div class="max-w-3xl">
            <h1 class="text-5xl md:text-7xl font-extrabold mb-6 tracking-tight" data-aos="fade-up">
                Resource <span class="text-accent">Center</span>
            </h1>
            <div class="w-24 h-2 bg-accent rounded-full mb-8" data-aos="fade-up" data-aos-delay="100"></div>
            <p class="text-xl text-gray-300 leading-relaxed mb-0" data-aos="fade-up" data-aos-delay="200">
                Access and download essential academic materials, administrative forms, and institutional documents
                curated for students and parents.
            </p>
        </div>
    </div>
</section>

<!-- Resources Main Section -->
<section class="py-20 bg-white">
    <div class="container mx-auto px-4">
        <!-- Filtering System -->
        <div class="flex flex-col md:flex-row md:items-center justify-between gap-6 mb-12" data-aos="fade-up">
            <div class="flex flex-wrap gap-2">
                <button data-filter="all"
                    class="px-6 py-2.5 rounded-full font-bold transition-all duration-300 bg-primary text-white shadow-lg shadow-primary/20 hover:scale-105 active">
                    All Files
                </button>
                {% for category in categories %}
                <button data-filter="{{ category.slug }}"
                    class="px-6 py-2.5 rounded-full font-bold transition-all duration-300 bg-gray-100 text-gray-600 hover:bg-primary/10 hover:text-primary border border-transparent hover:border-primary/20">
                    {{ category.name }}
                </button>
                {% endfor %}
            </div>

            <div class="text-sm font-bold text-gray-400 uppercase tracking-widest">
                {{ resources.count }} Resources Available
            </div>
        </div>

        <!-- Dynamic Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            {% for resource in resources %}
            {% with ext=resource.get_extension %}
            <div class="group h-full" data-category="{{ resource.category }}" data-aos="fade-up"
                data-aos-delay="{{ forloop.counter0|add:'50' }}">
                <div
                    class="bg-white rounded-[2rem] p-8 border border-gray-100 shadow-sm hover:shadow-2xl hover:border-primary/10 transition-all duration-500 h-full flex flex-col relative overflow-hidden">
                    <!-- Subtle Type Indicator -->
                    <div
                        class="absolute top-0 right-0 px-6 py-2 bg-gray-50 text-[10px] font-black uppercase text-gray-300 tracking-[0.2em] rounded-bl-2xl">
                        {{ ext|default:"Link" }}
                    </div>

                    <!-- Icon Container -->
                    <div class="mb-8 relative">
                        <div class="w-20 h-20 rounded-2xl flex items-center justify-center transition-all duration-500 transform group-hover:rotate-6 group-hover:scale-110
                            {% if ext == 'pdf' %}bg-red-50 text-red-500
                            {% elif ext == 'docx' or ext == 'doc' %}bg-blue-50 text-blue-500
                            {% elif ext == 'xlsx' or ext == 'xls' %}bg-green-50 text-green-500
                            {% else %}bg-primary/5 text-primary{% endif %}">

                            {% if ext == 'pdf' %}
                            <i class="fas fa-file-pdf text-4xl"></i>
                            {% elif ext == 'docx' or ext == 'doc' %}
                            <i class="fas fa-file-word text-4xl"></i>
                            {% elif ext == 'xlsx' or ext == 'xls' %}
                            <i class="fas fa-file-excel text-4xl"></i>
                            {% elif not resource.file %}
                            <i class="fas fa-link text-4xl"></i>
                            {% else %}
                            <i class="fas fa-file-alt text-4xl"></i>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Content -->
                    <div class="flex-grow">
                        <div class="flex items-center gap-2 mb-3">
                            <span
                                class="px-3 py-1 bg-primary/5 text-primary text-[10px] font-bold uppercase tracking-wider rounded-md">
                                {{ resource.get_category_display }}
                            </span>
                        </div>
                        <h3
                            class="text-xl font-bold text-gray-900 mb-3 group-hover:text-primary transition-colors leading-tight">
                            {{ resource.title }}
                        </h3>
                        {% if resource.description %}
                        <p class="text-gray-500 text-sm mb-6 line-clamp-2 leading-relaxed">
                            {{ resource.description }}
                        </p>
                        {% endif %}
                    </div>

                    <!-- Meta & Actions -->
                    <div class="mt-auto border-t border-gray-100 pt-6">
                        <div
                            class="flex items-center justify-between mb-6 text-[11px] font-bold text-gray-400 uppercase tracking-wider">
                            <span class="flex items-center gap-1.5">
                                <i class="far fa-calendar-alt text-gray-300"></i>
                                {{ resource.created_at|date:"M d, Y" }}
                            </span>
                            {% if resource.get_file_size %}
                            <span class="flex items-center gap-1.5">
                                <i class="fas fa-hdd text-gray-300"></i>
                                {{ resource.get_file_size }}
                            </span>
                            {% endif %}
                        </div>

                        {% if resource.file %}
                        <a href="{{ resource.file.url }}" hx-post="{% url 'track_download' resource.pk %}"
                            hx-trigger="click" hx-swap="none" download
                            class="flex items-center justify-center gap-3 w-full py-4 bg-gray-900 text-white rounded-2xl font-bold hover:bg-primary hover:shadow-xl hover:shadow-primary/30 transition-all duration-300 transform active:scale-95 group/btn">
                            <span class="group-hover/btn:-translate-y-0.5 transition-transform duration-300">Download
                                Report</span>
                            <i
                                class="fas fa-arrow-down-long group-hover/btn:translate-y-0.5 transition-transform duration-300"></i>
                        </a>
                        {% else %}
                        <a href="{{ resource.external_link }}" target="_blank"
                            class="flex items-center justify-center gap-3 w-full py-4 bg-gray-100 text-primary rounded-2xl font-bold hover:bg-primary/10 transition-all duration-300 group/btn">
                            <span>Open Resource</span>
                            <i
                                class="fas fa-arrow-up-right-from-square transition-transform group-hover/btn:-translate-y-0.5 group-hover/btn:translate-x-0.5"></i>
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endwith %}
            {% empty %}
            <div class="col-span-full py-32 text-center" data-aos="fade-up">
                <div
                    class="w-32 h-32 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-8 border-2 border-dashed border-gray-100">
                    <i class="fas fa-cloud-sun text-5xl text-gray-200"></i>
                </div>
                <h3 class="text-3xl font-black text-gray-900 mb-4">No Resources Found</h3>
                <p class="text-gray-500 max-w-md mx-auto leading-relaxed">
                    We're currently cataloging our latest documents. Please check back shortly or contact the
                    administrative office.
                </p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Support Section -->
<section class="py-24 bg-gray-50 relative overflow-hidden">
    <div class="absolute top-0 right-0 p-32 opacity-[0.02] transform rotate-12 pointer-events-none">
        <i class="fas fa-folder-open text-[20rem]"></i>
    </div>

    <div class="container mx-auto px-4 relative z-10">
        <div
            class="bg-gradient-to-br from-primary to-primary-dark rounded-[3rem] p-12 md:p-20 text-white shadow-2xl overflow-hidden relative">
            <div class="absolute inset-0 decorative-dots opacity-10"></div>

            <div class="max-w-4xl mx-auto text-center">
                <h2 class="text-3xl md:text-5xl font-black mb-6" data-aos="fade-up">Couldn't find what you need?</h2>
                <p class="text-xl text-primary-light/80 mb-12 max-w-2xl mx-auto leading-relaxed" data-aos="fade-up"
                    data-aos-delay="100">
                    Our administrative team is here to assist you with specific document requests or technical issues
                    related to downloads.
                </p>

                <div class="flex flex-wrap justify-center gap-6" data-aos="fade-up" data-aos-delay="200">
                    {% if school_info.email %}
                    <a href="mailto:{{ school_info.email }}"
                        class="group flex items-center gap-4 bg-white text-primary px-8 py-5 rounded-2xl font-bold hover:bg-accent hover:text-white transition-all duration-300 shadow-xl shadow-black/10">
                        <i class="fas fa-envelope-open text-xl group-hover:rotate-12 transition-transform"></i>
                        Direct Email Support
                    </a>
                    {% endif %}

                    {% if school_info.phone %}
                    <a href="tel:{{ school_info.phone }}"
                        class="flex items-center gap-4 bg-white/10 backdrop-blur-md text-white border border-white/20 px-8 py-5 rounded-2xl font-bold hover:bg-white/20 transition-all duration-300">
                        <i class="fas fa-phone-volume text-xl"></i>
                        Immediate Assistance
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- JavaScript for filtering -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const filterButtons = document.querySelectorAll('[data-filter]');
        const resourceCards = document.querySelectorAll('.group[data-category]');

        filterButtons.forEach(button => {
            button.addEventListener('click', function () {
                const filterValue = this.getAttribute('data-filter');

                // Update button styles
                filterButtons.forEach(btn => {
                    btn.classList.remove('bg-primary', 'text-white', 'shadow-lg', 'shadow-primary/20', 'active');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                this.classList.remove('bg-gray-100', 'text-gray-600');
                this.classList.add('bg-primary', 'text-white', 'shadow-lg', 'shadow-primary/20', 'active');

                // Filter cards
                resourceCards.forEach(card => {
                    if (filterValue === 'all' || card.getAttribute('data-category') === filterValue) {
                        card.style.display = 'block';
                        card.classList.add('animate-fadeInUp');
                    } else {
                        card.style.display = 'none';
                    }
                });
            });
        });
    });
</script>
{% endblock %}